
---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Login">
  <div class="page-center">
    <h1 class="text-2xl font-bold mb-4">Login</h1>

    <form id="loginForm" class="flex flex-col gap-4 max-w-sm">
      <div>
        <label class="block mb-1">Email</label>
        <input id="email" type="email" class="w-full p-2 border rounded" required />
        <p id="emailError" class="text-red-600 text-sm hidden">Email inv치lido</p>
      </div>

      <div>
        <label class="block mb-1">Contrase침a</label>
        <input id="password" type="password" class="w-full p-2 border rounded" required />
        <p id="passwordError" class="text-red-600 text-sm hidden">La contrase침a es obligatoria</p>
      </div>

      <button
        type="submit"
        class="bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
      >
        Iniciar sesi칩n
      </button>
    </form>

    <script>
      const form = document.getElementById("loginForm") as HTMLFormElement;

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const email = document.getElementById("email") as HTMLInputElement;
        const password = document.getElementById("password") as HTMLInputElement;

        const emailError = document.getElementById("emailError") as HTMLParagraphElement;
        const passwordError = document.getElementById("passwordError") as HTMLParagraphElement;

        let valid = true;

        if (!email.value.includes("@")) {
          emailError.classList.remove("hidden");
          valid = false;
        } else {
          emailError.classList.add("hidden");
        }

        if (password.value.trim() === "") {
          passwordError.classList.remove("hidden");
          valid = false;
        } else {
          passwordError.classList.add("hidden");
        }

        if (!valid) return;

        localStorage.setItem("user", JSON.stringify({ email: email.value }));
        window.location.href = "/profile";
      });
    </script>
  </div>
</BaseLayout>
